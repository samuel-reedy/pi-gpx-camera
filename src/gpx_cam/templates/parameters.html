<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Parameters</title>
    <style>
        body {
            background-color: #222222;
            font-family: Arial, sans-serif;
        }
        .parameters-container {
            display: flex;
            flex-direction: column;
            max-width: 100%;
            padding: 20px;
        }
        .parameter-group {
            background-color: #333333;
            gap: 10px;
            border-radius: 10px;
            padding: 10px;
            margin: 5px 0;
        }
        .parameter-group h2 {
            color: rgb(255, 255, 255);
            margin: 5px;
            font-size: 20px;
        }
        .parameter {
            display: flex;
            justify-content: space-between;
            align-items: center; /* Add this line to center the text vertically */
            padding: 3px;
            border-radius: 2px;
            background-color: rgba(0, 0, 0, 0.1);
            margin: 5px;
            margin-left:30px;
            height: 30px;
            font-size: 15px;
        }
        .parameter label {
            /* font-weight: bold; */
            color: rgb(218, 223, 233);
            width: 150px;
            text-align: left;
        }
        .parameter span {
            font-weight: normal;
            color: rgb(226, 229, 236);
            width: 200px;
            text-align: left;
        }
        .parameter input {
            font-weight: bold;
            padding: 5px;
            background-color: #222222;
            color: rgb(255, 255, 255);
            border-color: white;
            width: 200px;
            text-align: left;
            box-sizing: border-box;
        }

        .parameter .details {
            font-size: 0.8em;
            color: rgb(163, 167, 179);
            text-align: left;
            width: 400px;
        }
        
        #submit {
            font-weight: bold;
            padding: 5px;
            background-color: #0a7900;
            color: rgb(255, 255, 255);
            width:100%;
            height: 40px;
        }

        #updateMessage {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background-color: rgba(0, 128, 0, 0.8); /* Semi-transparent green background */
            color: white;
            text-align: center;
            padding: 10px;
            font-size: 20px;
            z-index: 1000; /* Ensure it appears on top */
            transition: opacity 1s ease-out; /* Transition for fade-out effect */
        }

        #updateMessage.fade-out {
            opacity: 0; /* Fade-out effect */
        }


    </style>
</head>
<body>
    <input type="hidden" id="ip" value="$ip">
    <input type="hidden" id="port" value="$port">
    <div id="streamStage">
        <div class="parameters-container">
            <div class="parameter-group">
                <h2>General</h2>
                <div class="parameter">
                    <label>IP:</label>
                    <span class="details">The IP address of the device.</span>
                    <span id="ip">$ip</span>
                </div>
                <div class="parameter">
                    <label>Port:</label>
                    <span class="details">The port number of the device.</span>
                    <span id="port">$port</span>
                </div>
                <div class="parameter">
                    <label>WS URL:</label>
                    <span class="details">The WebSocket URL of the device.</span>
                    <span id="wsURL">$wsURL</span>
                </div>
                <div class="parameter">
                    <label>Cam Type:</label>
                    <span class="details">The type of camera.</span>
                    <span id="cam_type">$cam_type</span>
                </div>
            </div>


            <div class="parameter-group">
                <h2>Stream</h2>
                <div class="parameter">
                    <label>Framerate:</label>
                    <span class="details">The framerate of the camera stream.</span>
                    <input type="text" id="cam_framerate" value="$cam_framerate">
                </div>
                <div class="parameter">
                    <label>Resolution:</label>
                    <span class="details">The resolution of the camera stream.</span>
                    <span id="stream_resolution">$stream_resolution</span>
                </div>
                <div class="parameter">
                    <label>Exposure:</label>
                    <span class="details">The exposure setting of the camera.</span>
                    <input type="text" id="cam_exposure" value="$cam_exposure">
                </div>
            </div>


            <div class="parameter-group">
                <h2>Recording</h2>
                <div class="parameter">
                    <label>Framerate:</label>
                    <span class="details">The framerate of the recorded video.</span>
                    <input type="text" id="rec_framerate" value="$rec_framerate">
                </div>
                <div class="parameter">
                    <label>Store GPX:</label>
                    <span class="details">Whether to store GPX data.</span>
                    <input type="text" id="store_gpx" value="$store_gpx">
                </div>
                <div class="parameter">
                    <label>Filename:</label>
                    <span class="details">The filename of the recorded video.</span>
                    <input type="text" id="record_filename" value="$record_filename">
                </div>
                <div class="parameter">
                    <label>Run Camera:</label>
                    <span class="details">Whether to run the camera.</span>
                    <span id="run_camera">$run_camera</span>
                </div>
                <div class="parameter">
                    <label>Is Recording:</label>
                    <span class="details">Whether the camera is currently recording.</span>
                    <span id="is_recording">$is_recording</span>
                </div>
                <div class="parameter">
                    <label>Resolution Scale:</label>
                    <span class="details">The scale of the video resolution.</span>
                    <input type="text" id="resolution" value="$resolution">
                </div>
                <div class="parameter">
                    <label>JPG Quality:</label>
                    <span class="details">The quality of the JPEG images.</span>
                    <input type="text" id="jpg_quality" value="$jpg_quality">
                </div>
                <div class="parameter">
                    <label>Framerate JS:</label>
                    <span class="details">The framerate of the JavaScript code.</span>
                    <span id="framerate_js">$framerate_js</span>
                </div>
            </div>


            <div class="parameter-group">
                <h2>Gauge</h2>
                <div class="parameter">
                    <label>Ideal Depth:</label>
                    <span class="details">The ideal depth for the gauge.</span>
                    <input type="text" id="ideal_depth" value="$ideal_depth">
                </div>
                <div class="parameter">
                    <label>Min Radius:</label>
                    <span class="details">The minimum radius for the gauge.</span>
                    <input type="text" id="min_radius" value="$min_radius">
                </div>
                <div class="parameter">
                    <label>Max Radius:</label>
                    <span class="details">The maximum radius for the gauge.</span>
                    <input type="text" id="max_radius" value="$max_radius">
                </div>
                <div class="parameter">
                    <label>Max Depth Difference:</label>
                    <span class="details">The maximum difference in depth for the gauge.</span>
                    <input type="text" id="max_depth_difference" value="$max_depth_difference">
                </div>
            </div>


            <div class="parameter-group">
                <h2>MAVLINK MESSAGE</h2>
                
                <div class="parameter">
                    <label>Latitude:</label>
                    <span class="details">The latitude of the device.</span>
                    <span id="lat">$lat</span>
                </div>
                <div class="parameter">
                    <label>Longitude:</label>
                    <span class="details">The longitude of the device.</span>
                    <span id="lon">$lon</span>
                </div>
                <div class="parameter">
                    <label>Altitude:</label>
                    <span class="details">The altitude of the device.</span>
                    <span id="alt">$alt</span>
                </div>
                <div class="parameter">
                    <label>Relative Altitude:</label>
                    <span class="details">The relative altitude of the device.</span>
                    <span id="relative_alt">$relative_alt</span>
                </div>
                <div class="parameter">
                    <label>VX:</label>
                    <span class="details">The velocity in the X direction.</span>
                    <span id="vx">$vx</span>
                </div>
                <div class="parameter">
                    <label>VY:</label>
                    <span class="details">The velocity in the Y direction.</span>
                    <span id="vy">$vy</span>
                </div>
                <div class="parameter">
                    <label>VZ:</label>
                    <span class="details">The velocity in the Z direction.</span>
                    <span id="vz">$vz</span>
                </div>
                <div class="parameter">
                    <label>Heading:</label>
                    <span class="details">The heading of the device.</span>
                    <span id="hdg">$hdg</span>
                </div>
                <div class="parameter">
                    <label>Satellites:</label>
                    <span class="details">The number of visible satellites.</span>
                    <span id="mav_satellites_visible">$mav_satellites_visible</span>
                </div>
                <div class="parameter">
                    <label>Start Position:</label>
                    <span class="details">The starting position of the recording.</span>
                    <span id="rec_start_position">$rec_start_position</span>
                </div>
                
            </div>


            <div class="parameter-group">
                <div class="parameter">
                    <button id="submit" type="submit">Update Parameters</button>
                </div>
            </div>

            <div id="updateMessage">Parameters updated</div>

            </form>
        </div>
    </div>

    <script>
        document.getElementById("submit").addEventListener("click", function(event) {
            event.preventDefault(); // Prevent form submission

            // Create JSON object from form inputs
            var data = {
                cam_exposure: document.getElementById("cam_exposure").value,
                cam_framerate: document.getElementById("cam_framerate").value,
                rec_framerate: document.getElementById("rec_framerate").value,
                store_gpx: document.getElementById("store_gpx").value,
                record_filename: document.getElementById("record_filename").value,
                resolution: document.getElementById("resolution").value,
                jpg_quality: document.getElementById("jpg_quality").value,
                ideal_depth: document.getElementById("ideal_depth").value,
                min_radius: document.getElementById("min_radius").value,
                max_radius: document.getElementById("max_radius").value,
                max_depth_difference: document.getElementById("max_depth_difference").value,
                ip: document.getElementById("ip").value,
                port: document.getElementById("port").value,
                wsURL: document.getElementById("wsURL").value,
                cam_type: document.getElementById("cam_type").value,
                stream_resolution: document.getElementById("stream_resolution").value,
                run_camera: document.getElementById("run_camera").value,
                is_recording: document.getElementById("is_recording").value,
                framerate_js: document.getElementById("framerate_js").value,
                lat: document.getElementById("lat").value,
                lon: document.getElementById("lon").value,
                alt: document.getElementById("alt").value,
                relative_alt: document.getElementById("relative_alt").value,
                vx: document.getElementById("vx").value,
                vy: document.getElementById("vy").value,
                vz: document.getElementById("vz").value,
                hdg: document.getElementById("hdg").value,
                mav_satellites_visible: document.getElementById("mav_satellites_visible").value,
                rec_start_position: document.getElementById("rec_start_position").value
            };

            // Send JSON data to /settings endpoint
            fetch("/settings", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(data => {
                console.log("Settings updated:", data);
                var updateMessage = document.getElementById("updateMessage");
                updateMessage.style.display = "block";
                // Hide the message after 2 seconds
                setTimeout(function() {
                    updateMessage.classList.add("fade-out");
                    // Remove the message from the DOM after the fade-out transition
                    setTimeout(function() {
                        updateMessage.style.display = "none";
                        updateMessage.classList.remove("fade-out");
                    }, 1000); // Match the duration of the CSS transition
                }, 2000);
            })
            .catch(error => {
                console.error("Error updating settings:", error);
                // Handle error if needed
            });
        });
    </script>
</body>
</html>
